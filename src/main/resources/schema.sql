drop table IF EXISTS users CASCADE;
drop table IF EXISTS requests CASCADE;
drop table IF EXISTS items CASCADE;
drop table IF EXISTS bookings CASCADE;
drop table IF EXISTS comments CASCADE;

CREATE TABLE users (id BIGINT GENERATED BY DEFAULT AS IDENTITY, name VARCHAR(255) NOT NULL, email VARCHAR(512) NOT NULL, CONSTRAINT pk_user PRIMARY KEY (id), CONSTRAINT UQ_USER_EMAIL UNIQUE (email));
CREATE TABLE requests (id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, description VARCHAR(255) NOT NULL, requester_id BIGINT REFERENCES users(id) NOT NULL, CONSTRAINT pk_request PRIMARY KEY (id));
CREATE TABLE items (id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, name VARCHAR(255) NOT NULL, description VARCHAR(512) NOT NULL, is_available BOOLEAN NOT NULL, owner_id BIGINT REFERENCES users(id) NOT NULL, request_id BIGINT REFERENCES requests(id), CONSTRAINT pk_item PRIMARY KEY (id));
CREATE TABLE bookings (id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, start_date timestamp NOT NULL, end_date timestamp NOT NULL CHECK(end_date > start_date), status VARCHAR(255) NOT NULL, item_id BIGINT REFERENCES items(id) NOT NULL, booker_id BIGINT REFERENCES users(id) NOT NULL, CONSTRAINT pk_booking PRIMARY KEY (id));
CREATE TABLE comments (id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, text VARCHAR(255) NOT NULL, item_id BIGINT REFERENCES items(id) NOT NULL, author_id BIGINT REFERENCES users(id) NOT NULL, created timestamp NOT NULL, CONSTRAINT pk_comment PRIMARY KEY (id));
